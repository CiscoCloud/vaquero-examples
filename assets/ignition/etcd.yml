---
networkd:
  units:
    - name: 10-static.network
      contents: |
        [Match]
        MACAddress={{.interface.mac}}
        [Network]
        Gateway={{.host.subnet.gateway}}
        DNS={{ index .host.subnet.dns 0 }}
        Address={{ .interface.ipv4 }}
{{ if index .env "ssh_authorized_keys" }}

systemd:
  units:
    {{ template "etcd2" .}}

passwd:
  users:
    - name: core
      ssh_authorized_keys:
        {{ range $element := .env.ssh_authorized_keys }}
        - {{$element}}
        {{end}}
{{end}}
